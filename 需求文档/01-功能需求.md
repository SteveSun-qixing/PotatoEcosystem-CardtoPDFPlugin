# CardtoPDFPlugin 功能需求文档

## 模块定位

CardtoPDFPlugin 是薯片生态文件转换系统的插件之一，负责将卡片文件转换为 PDF 文档。插件依赖 CardtoHTMLPlugin 先将卡片转换为 HTML，然后使用浏览器的 PDF 打印功能生成 PDF 文件。

## 核心功能

### HTML 生成

插件首先调用 CardtoHTMLPlugin 将卡片转换为 HTML。复用 CardtoHTMLPlugin 的所有能力，包括卡片解析、渲染代码获取、主题应用等。

### PDF 生成

使用 Puppeteer 或 Playwright 启动无头浏览器，加载生成的 HTML 页面。使用浏览器的打印功能将页面输出为 PDF 格式。PDF 保持页面的完整布局和样式。

### 页面设置

支持多种页面大小：A4、Letter、Legal、A3 等标准尺寸，也支持自定义尺寸。支持横向和纵向两种页面方向。支持设置页边距，包括上下左右四个方向的边距值。

### 封面和目录

可选生成封面页，显示卡片名称、创建时间等元信息。可选生成目录页，列出所有基础卡片的标题和页码。封面和目录的样式跟随当前主题。

## 配置选项

页面大小选项指定 PDF 页面大小，默认 A4。页面方向选项指定横向或纵向，默认纵向。边距选项指定四个方向的边距值。封面选项控制是否生成封面页，默认 true。目录选项控制是否生成目录页，默认 false。

打印背景选项控制是否打印背景颜色和图片，默认 true。缩放选项控制页面缩放比例。

## 错误处理

浏览器启动失败、页面加载超时、PDF 生成失败等情况都有对应的错误处理。CardtoHTMLPlugin 转换失败时直接返回其错误信息。

## 依赖关系

插件依赖 CardtoHTMLPlugin 进行 HTML 转换。依赖 Puppeteer 或 Playwright 进行 PDF 生成。
